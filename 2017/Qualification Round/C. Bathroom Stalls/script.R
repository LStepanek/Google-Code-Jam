###############################################################################
###############################################################################
###############################################################################

## I am loading input data ----------------------------------------------------

my_input <- file.choose()
my_data <- readLines(my_input)


## ----------------------------------------------------------------------------

###############################################################################

## I am changing a working directory ------------------------------------------

setwd(
    gsub("(.*\\\\)(.*)", "\\1", my_input)
)


## ----------------------------------------------------------------------------

###############################################################################

## helper functions -----------------------------------------------------------

solveTheCase <- function(my_case){
    
    # '''
    # Returns a solution for one case of the input data.
    # '''
    
    N <- as.integer(strsplit(my_case, split = " ")[[1]][1])
    K <- as.integer(strsplit(my_case, split = " ")[[1]][2])
    
    l <- floor(log2(K))
    
    my_fraction <- (N - 2 ^ l + 1) / (2 ^ l)
    
    if(K - 2 ^ l + 1 <= ((my_fraction) - floor(my_fraction)) * 2 ^ l){
        
        ## "lcs_of_empty_stalls" is longest consecutive subsequence of empty
        ## stalls which is available for K-th person when she is choosing
        ## their stall --------------------------------------------------------
        
        lcs_of_empty_stalls <- ceiling(my_fraction)
        
    }else{
        
        lcs_of_empty_stalls <- floor(my_fraction)
        
    }
    
    return(
        
        paste(
            
            format(c(
                
                ceiling((lcs_of_empty_stalls - 1) / 2),
                floor((lcs_of_empty_stalls - 1) / 2)
                
            ), scientific = FALSE),            
            collapse = " "
            
        )
        
    )    
    
}


## ----------------------------------------------------------------------------

###############################################################################

## flow control ---------------------------------------------------------------

if(
    as.integer(my_data[1]) != length(my_data) - 1
){
    stop("Number of cases is fishy.", call. = FALSE)
}


## ----------------------------------------------------------------------------

###############################################################################

## core computations ----------------------------------------------------------

my_output <- NULL

for(i in 1:as.integer(my_data[1])){

    my_case <- my_data[i + 1]

    my_output <- c(
        my_output,
        paste(
            "Case #",
            i,
            ": ",
            solveTheCase(my_case),
            sep = ""
        )
    )
    
    flush.console()
    print(
        paste(
            "Process is ",
            format(
                round(
                    i / as.integer(my_data[1]) * 100,
                    digits = 2
                ),
                nsmall = 2
            ),
            " % complete.",
            sep = ""            
        )
    )
    
}


## ----------------------------------------------------------------------------

###############################################################################

## I am giving an output ------------------------------------------------------

writeLines(
    my_output,
    con = gsub(
        ".in",
        "-out.in",
        gsub("(.*\\\\)(.*)", "\\2", my_input)
    )
)


## ----------------------------------------------------------------------------

###############################################################################
###############################################################################
###############################################################################





